<!DOCTYPE html>
<html>
<head>
    <title>Text-to-Image API示例</title>
</head>
<body>
    <h1>Text-to-Image API示例</h1>

    <label for="prompt1">Prompt 1：</label>
    <input type="text" id="prompt1" placeholder="輸入提示1"><br><br>

    <label for="prompt2">Prompt 2：</label>
    <input type="text" id="prompt2" placeholder="輸入提示2"><br><br>

    <label for="prompt3">Prompt 3：</label>
    <input type="text" id="prompt3" placeholder="輸入提示3"><br><br>

    <button onclick="generateImages()">生成圖片</button><br><br>

    <div id="imageContainer">
        <!-- 這裡將顯示生成的圖片 -->
    </div>

    <script>
        async function generateImages() {
            const prompt1 = document.getElementById('prompt1').value;
            const prompt2 = document.getElementById('prompt2').value;
            const prompt3 = document.getElementById('prompt3').value;
            const imageContainer = document.getElementById('imageContainer');

            // 請將下面的URL替換為你的API端點
            const apiUrl = 'https://zhihmeng.ddns.net/sdapi/v1/txt2img';



            
            var myHeaders = new Headers();
            myHeaders.append("Content-Type", "application/json");
            
            var raw = JSON.stringify({
              "denoising_strength": 0,
              "prompt": prompt1 + "," + prompt2 + "," + prompt3 + ",a image of cd cover",
              "negative_prompt": "easy negative",
              "seed": -1,
              "batch_size": 1,
              "n_iter": 1,
              "steps": 50,
              "cfg_scale": 7,
              "width": 512,
              "height": 512,
              "restore_faces": false,
              "tiling": false,
              "multi_lingual": "yes",
              "override_settings": {
              "sd_model_checkpoint" :"v1-5-pruned-emaonly.safetensors [6ce0161689]"
              },
              "script_args": [
                  0,
                  true,
                  true,
                  "LoRA",
                  "dingzhenlora_v1(fa7c1732cc95)",
                  1,
                  1
              ],
              "sampler_index": "Euler"
            });
            
            var requestOptions = {
              method: 'POST',
              headers: myHeaders,
              body: raw,
              redirect: 'follow'
            };

            // fetch(apiUrl, requestOptions)
            //   .then(response => response.text())
            //   .then(result => console.log(result))
            //   .catch(error => console.log('error', error));

            try {
                const response = await fetch(apiUrl, requestOptions);

                const data = await response.json();

                // 顯示生成的Base64圖片
                imageContainer.innerHTML = `
                    <img src="data:image/png;base64, ${data.images}" alt="Image 1">
                    <img src="data:image/png;base64, ${data.images}" alt="Image 2">
                    <img src="data:image/png;base64, ${data.images}" alt="Image 3">
                `;
            } catch (error) {
                console.error('發生錯誤:', error);
            }
        }
    </script>
</body>
</html>
